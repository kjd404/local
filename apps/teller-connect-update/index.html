<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Teller Enrollment Update</title>
</head>
<body>
  <h1>Teller Enrollment Update</h1>
  <button id="update">Update Enrollment</button>
  <pre id="log"></pre>

  <!-- Injected at build/run time -->
  <script src="env.js"></script>

  <!-- Teller Connect widget -->
  <script src="https://cdn.teller.io/connect/connect.js"></script>
  <script>
    const log = (msg) => {
      document.getElementById("log").textContent += msg + "\n";
    };

    const appId = window.__ENV__.APP_ID;
    const enrollmentId = window.__ENV__.ENROLLMENT_ID;
    const environment = window.__ENV__.ENV || "production";

    const connect = TellerConnect.setup({
      applicationId: appId,
      environment,
      onSuccess(enrollment) {
        log("Update complete, new enrollment id: " + enrollment.id);
        console.log("Enrollment:", enrollment);
      },
      onExit(e) { log("Exited: " + JSON.stringify(e)); },
      onError(e) { log("Error: " + JSON.stringify(e)); }
    });

    document.getElementById("update").addEventListener("click", () => {
      log("Starting update flow...");
      connect.update({ enrollmentId });
    });
  </script>
</body>
</html>
